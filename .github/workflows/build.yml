name: Deploy em Servidor Front (Clean Build All)

on:
  push:
    branches:
      - main

jobs:
  build-and-deploy:
    name: Build e Deploy da AplicaÃ§Ã£o (Do Zero)
    runs-on: self-hosted

    steps:
      - name: (FRONT) - ðŸ“¥ Baixar cÃ³digo do repositÃ³rio
        uses: actions/checkout@v4

      #FRONTEND ----------------------------------------------------------------------------
       
      - name: (FRONT) - ðŸ›‘ Desligar e remover serviÃ§os antigos
        run: docker compose -f docker-compose.dev.yml down --rmi all --volumes || true
        working-directory: ./app/front

      - name: (FRONT) - ðŸš€ Reconstruir e rodar com Docker Compose (sem cache)
        run: docker compose -f docker-compose.dev.yml up --build -d
        working-directory: ./app/front

      # REMOVIDO: - ðŸ§¹ Limpeza completa do sistema Docker (era agressivo)
      # - name: (FRONT) - ðŸ§¹ Limpeza completa do sistema Docker
      #   if: always()
      #   run: docker system prune -af



