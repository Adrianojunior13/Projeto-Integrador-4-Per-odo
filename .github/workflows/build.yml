name: Deploy em Servidor Front (Clean Build All)

on:
  push:
    branches:
      - main

jobs:
  build-and-deploy:
    name: Build e Deploy da AplicaÃ§Ã£o (Do Zero)
    runs-on: self-hosted

    steps:
      - name: (FRONT) - ðŸ“¥ Baixar cÃ³digo do repositÃ³rio
        uses: actions/checkout@v4

      #FRONTEND ----------------------------------------------------------------------------
      - name: (FRONT) - ðŸ›‘ Desligar e remover serviÃ§os antigos (containers e imagens)
        working-directory: ./app
        run: docker compose down --rmi all --volumes || true # Este comando jÃ¡ Ã© suficiente para o escopo do frontend

      - name: (FRONT) - ðŸš€ Reconstruir e rodar com Docker Compose (sem cache)
        working-directory: ./app
        run: docker compose up --build -d

      # REMOVIDO: - ðŸ§¹ Limpeza completa do sistema Docker (era agressivo)
      # - name: (FRONT) - ðŸ§¹ Limpeza completa do sistema Docker
      #   if: always()
      #   run: docker system prune -af
